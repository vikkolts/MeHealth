var D=Object.defineProperty;var b=Object.getOwnPropertySymbols;var h=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var y=(n,e,o)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,x=(n,e)=>{for(var o in e||(e={}))h.call(e,o)&&y(n,o,e[o]);if(b)for(var o of b(e))B.call(e,o)&&y(n,o,e[o]);return n};import{d as S,e as $,f as v,u as R,o as j,c as k,i as I,j as M,b as r,m as l}from"./index.cc5609fc.js";const O={class:"px-0"},N=S({__name:"SettingsManageData",setup(n){const e=$(),o=v(),{t:c}=R();async function g(){const s=x({},await e.getMoodRecordsList()),i=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(i),t.setAttribute("download",`MeHealth_exported_data_${new Date().toISOString()}.json`),t.click(),setTimeout(function(){window.URL.revokeObjectURL(t==null?void 0:t.href),t==null||t.remove()},3e4)}async function _(s){var d,p;let i=(p=(d=document.getElementById("import-file-input"))==null?void 0:d.files)==null?void 0:p[0];if(!i)return;let t=new FileReader;t.onload=async function(){var m;let u=typeof t.result=="string"?Object.values(JSON.parse(t.result)):void 0;if(!u)return;let f=0;for(const a of u)try{(a.date&&a.mood_id||a.date&&a.mood_id&&a.notes)&&/\d{4}-\d{2}-\d{2}/.test(a.date)&&/[0-5]/.test(a.date)&&(await e.saveMoodRecord({date:a.date,mood_id:a.mood_id,notes:(m=a.notes)==null?void 0:m.replace(/<[\s\S]*?>/,"")}),f++)}catch(C){console.log(C)}alert(`${c("SuccessfullyImportedRecords")}: ${f}`)},t.readAsText(i)}function w(){confirm(c("ConfirmClearDB"))&&e.cleanDataBase()}return(s,i)=>(j(),k("main",O,[I(M,{title:s.$t("ManageData"),"with-back-button":"",class:"px-4-safe"},null,8,["title"]),r("button",{type:"button",class:"primary button-bg min-h-[44px] w-full py-2 px-4-safe text-left body-text",onClick:g},l(s.$t("ExportData")),1),r("button",{type:"button",class:"primary button-bg min-h-[44px] my-4 w-full py-2 px-4-safe text-left body-text",onClick:i[0]||(i[0]=t=>o.value.click())},l(s.$t("ImportData")),1),r("input",{id:"import-file-input",ref_key:"importFileInput",ref:o,class:"hidden",type:"file",accept:"application/json",onChange:_},null,544),r("button",{type:"button",class:"danger button-bg min-h-[44px] w-full py-2 px-4-safe text-left body-text",onClick:w},l(s.$t("ClearDB")),1)]))}});export{N as default};
