var D=Object.defineProperty;var y=Object.getOwnPropertySymbols;var _=Object.prototype.hasOwnProperty,B=Object.prototype.propertyIsEnumerable;var b=(n,e,o)=>e in n?D(n,e,{enumerable:!0,configurable:!0,writable:!0,value:o}):n[e]=o,x=(n,e)=>{for(var o in e||(e={}))_.call(e,o)&&b(n,o,e[o]);if(y)for(var o of y(e))B.call(e,o)&&b(n,o,e[o]);return n};import{d as S,u as $,e as v,y as R,o as k,c as I,h as j,i as M,b as l,l as r}from"./index.5eaaf625.js";const O={class:"px-0"},N=S({name:"SettingsManageData",setup(n){const e=$(),o=v(),{t:c}=R();async function g(){const s=x({},await e.getMoodRecordsList()),i=new Blob([JSON.stringify(s,null,2)],{type:"application/json"}),t=document.createElement("a");t.href=URL.createObjectURL(i),t.setAttribute("download",`MeHealth_exported_data_${new Date().toISOString()}.json`),t.click(),setTimeout(function(){window.URL.revokeObjectURL(t==null?void 0:t.href),t==null||t.remove()},3e4)}async function w(s){var d,p;let i=(p=(d=document.getElementById("import-file-input"))==null?void 0:d.files)==null?void 0:p[0];if(!i)return;let t=new FileReader;t.onload=async function(){var m;let f=typeof t.result=="string"?Object.values(JSON.parse(t.result)):void 0;if(!f)return;let u=0;for(const a of f)try{(a.date&&a.mood_id||a.date&&a.mood_id&&a.notes)&&/\d{4}-\d{2}-\d{2}/.test(a.date)&&/[0-5]/.test(a.date)&&(await e.saveMoodRecord({date:a.date,mood_id:a.mood_id,notes:(m=a.notes)==null?void 0:m.replace(/<[\s\S]*?>/,"")}),u++)}catch(C){console.log(C)}alert(`${c("SuccessfullyImportedRecords")}: ${u}`)},t.readAsText(i)}function h(){confirm(c("ConfirmClearDB"))&&e.cleanDataBase()}return(s,i)=>(k(),I("main",O,[j(M,{title:s.$t("ManageData"),"with-back-button":"",class:"px-4-safe"},null,8,["title"]),l("button",{type:"button",class:"primary item-white-bg min-h-[44px] w-full py-2 px-4-safe text-left body-text",onClick:g},r(s.$t("ExportData")),1),l("button",{type:"button",class:"primary item-white-bg min-h-[44px] my-4 w-full py-2 px-4-safe text-left body-text",onClick:i[0]||(i[0]=t=>o.value.click())},r(s.$t("ImportData")),1),l("input",{id:"import-file-input",ref_key:"importFileInput",ref:o,class:"hidden",type:"file",accept:"application/json",onChange:w},null,544),l("button",{type:"button",class:"danger item-white-bg min-h-[44px] w-full py-2 px-4-safe text-left body-text",onClick:h},r(s.$t("ClearDB")),1)]))}});export{N as default};
